"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_get=function(e,t,n){for(var o=!0;o;){var s=e,r=t,i=n;a=d=l=void 0,o=!1,null===s&&(s=Function.prototype);var a=Object.getOwnPropertyDescriptor(s,r);if(void 0!==a){if("value"in a)return a.value;var l=a.get;return void 0===l?void 0:l.call(i)}var d=Object.getPrototypeOf(s);if(null===d)return void 0;e=d,t=r,n=i,o=!0}},_reactAddons=require("react/addons"),_reactAddons2=_interopRequireDefault(_reactAddons),_classnames=require("classnames"),_classnames2=_interopRequireDefault(_classnames),CSSTransitionGroup=_reactAddons2["default"].addons.CSSTransitionGroup,PureRenderMixin=_reactAddons2["default"].addons.PureRenderMixin,TAB=9,SPACEBAR=32,ALIGNMENTS=["center","right","left"],MENU_SIZES=["sm","md","lg","xl"],DropdownMenu=function(e){function t(e){var n=this;_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this._lastWindowClickEvent=null,this.close=function(e){var t=e.which||e.keyCode;t===SPACEBAR&&(n.props.close(),e.preventDefault())},this.handleClickOutside=function(e){if(n.props.closeOnOutsideClick){for(var t=_reactAddons2["default"].findDOMNode(n),o=e.target;o.parentNode;){if(o===t)return;o=o.parentNode}n.props.close(e)}},this.handleKeyDown=function(e){var t=e.which||e.keyCode;if(t===TAB){var o=_reactAddons2["default"].findDOMNode(n).querySelectorAll("button,a"),s=e.shiftKey?1:o.length-1;e.target==o[s]&&n.props.close(e)}},this.shouldComponentUpdate=PureRenderMixin.shouldComponentUpdate.bind(this),this.lastWindowClickEvent=null}return _inherits(t,e),_createClass(t,[{key:"componentDidUpdate",value:function(e){if(this.props.isOpen!==e.isOpen){var t=_reactAddons2["default"].findDOMNode(this).querySelector(".dd-menu > .dd-menu-items");this.props.isOpen&&!e.isOpen?(this.lastWindowClickEvent=this.handleClickOutside,document.addEventListener("click",this.lastWindowClickEvent),this.props.closeOnInsideClick&&t.addEventListener("click",this.props.close),t.addEventListener("onkeydown",this.close)):!this.props.isOpen&&e.isOpen&&(document.removeEventListener("click",this.lastWindowClickEvent),e.closeOnInsideClick&&t.removeEventListener("click",this.props.close),t.removeEventListener("onkeydown",this.close),this.lastWindowClickEvent=null)}}},{key:"componentWillUnmount",value:function(){this.lastWindowClickEvent&&document.removeEventListener("click",this.lastWindowClickEvent)}},{key:"render",value:function(){var e=this.props,t=e.menuAlign,n=e.align,o=e.inverse,s=e.size,r=e.className,i=_classnames2["default"]("dd-menu","dd-menu-"+(t||n),{"dd-menu-inverse":o},r,s?"dd-menu-"+s:null),a=this.props,l=a.textAlign,d=a.upwards,c=a.animAlign,u=a.animate,p=(a.enterTimeout,a.leaveTimeout,"dd-items-"+(l||n)),m={transitionName:"grow-from-"+(d?"up-":"")+(c||n),component:"div",className:_classnames2["default"]("dd-menu-items",{"dd-items-upwards":d}),onKeyDown:this.handleKeyDown,transitionEnter:u,transitionLeave:u};return _reactAddons2["default"].createElement("div",{className:i},this.props.toggle,_reactAddons2["default"].createElement(CSSTransitionGroup,m,this.props.isOpen&&_reactAddons2["default"].createElement("ul",{key:"items",className:p},this.props.children)))}}],[{key:"propTypes",value:{isOpen:_reactAddons.PropTypes.bool.isRequired,close:_reactAddons.PropTypes.func.isRequired,toggle:_reactAddons.PropTypes.node.isRequired,children:_reactAddons.PropTypes.node,inverse:_reactAddons.PropTypes.bool,align:_reactAddons.PropTypes.oneOf(ALIGNMENTS),animAlign:_reactAddons.PropTypes.oneOf(ALIGNMENTS),textAlign:_reactAddons.PropTypes.oneOf(ALIGNMENTS),menuAlign:_reactAddons.PropTypes.oneOf(ALIGNMENTS),className:_reactAddons.PropTypes.string,size:_reactAddons.PropTypes.oneOf(MENU_SIZES),upwards:_reactAddons.PropTypes.bool,animate:_reactAddons.PropTypes.bool,closeOnInsideClick:_reactAddons.PropTypes.bool,closeOnOutsideClick:_reactAddons.PropTypes.bool},enumerable:!0},{key:"defaultProps",value:{inverse:!1,align:"center",animAlign:null,textAlign:null,menuAlign:null,className:null,size:null,upwards:!1,animate:!0,closeOnInsideClick:!0,closeOnOutsideClick:!0},enumerable:!0},{key:"MENU_SIZES",value:MENU_SIZES,enumerable:!0},{key:"ALIGNMENTS",value:ALIGNMENTS,enumerable:!0}]),t}(_reactAddons.Component);module.exports=DropdownMenu;var NestedDropdownMenu=function(e){function t(e){var n=this;_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e),this.handleToggleComponentClick=function(e){e.stopPropagation(),n.setState({isClickOpen:!n.state.isClickOpen})},this.handleMouseOver=function(){n.closeCallback&&(clearTimeout(n.closeCallback),n.closeCallback=null),n.setState({isHoverOpen:!0})},this.handleMouseLeave=function(){n.closeCallback=setTimeout(function(){n.setState({isHoverOpen:!1})}.bind(n),n.props.delay)},this.shouldComponentUpdate=PureRenderMixin.shouldComponentUpdate.bind(this),this.toggleComponent=null,this.closeCallback=null,this.state={isHoverOpen:!1,isClickOpen:!1}}return _inherits(t,e),_createClass(t,[{key:"componentDidMount",value:function(){this.toggleComponent=ReactDOM.findDOMNode(this).querySelector("*"),this.toggleComponent.addEventListener("click",this.handleToggleComponentClick)}},{key:"componentWillUnmount",value:function(){this.closeCallback&&clearTimeout(this.closeCallback),this.toggleComponent.removeEventListener("click",this.handleToggleComponentClick)}},{key:"render",value:function(){var e=this.props,t=e.toggle,n=e.children,o=e.nested,s=e.animate,r=e.direction,i=e.upwards,a=e.enterTimeout,l=e.leaveTimeout,d=this.state.isHoverOpen||this.state.isClickOpen,c={className:_classnames2["default"]("nested-dd-menu","nested-"+o)};this.props.openOnMouseover&&(c.onMouseOver=this.handleMouseOver,c.onMouseLeave=this.handleMouseLeave);var u=i?"up-":"",p={className:"dd-item-ignore",transitionEnter:s,transitionLeave:s,transitionName:"grow-from-"+u+r,transitionEnterTimeout:a,transitionLeaveTimeout:l};return _reactAddons2["default"].createElement("li",c,t,_reactAddons2["default"].createElement(CSSTransitionGroup,p,d?_reactAddons2["default"].createElement("ul",{key:"items"},n):null))}}],[{key:"propTypes",value:{toggle:_reactAddons.PropTypes.node.isRequired,children:_reactAddons.PropTypes.node,nested:_reactAddons.PropTypes.oneOf(["inherit","reverse","left","right"]),animate:_reactAddons.PropTypes.bool,direction:_reactAddons.PropTypes.oneOf(["left","right"]),upwards:_reactAddons.PropTypes.bool,delay:_reactAddons.PropTypes.number,enterTimeout:_reactAddons.PropTypes.number,leaveTimeout:_reactAddons.PropTypes.number,openOnMouseover:_reactAddons.PropTypes.bool},enumerable:!0},{key:"defaultProps",value:{nested:"reverse",animate:!1,direction:"right",upwards:!1,delay:500,enterTimeout:150,leaveTimeout:150,openOnMouseover:!0},enumerable:!0}]),t}(_reactAddons.Component);module.exports.NestedDropdownMenu=NestedDropdownMenu;